<!DOCTYPE html>
<html lang="zh-CN" class="antialiased scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÊµÅÂÖâÂ≠òÊ†π | Digital Garden v62.3 CHART_AXIS</title>
    
    <!-- Ê†∏ÂøÉ CSS ÂºïÊìé -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        leviathan: {
                            bg: '#0c0b0a',
                            surface: 'var(--surface-color)',
                            border: 'var(--border-color)',
                            accent: '#e3b341',
                        }
                    },
                    fontFamily: {
                        serif: ['"Noto Serif SC"', 'serif'],
                        mono: ['"JetBrains Mono"', 'monospace'],
                    },
                    animation: {
                        'fade-in-pro': 'fadeIn 1s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'slide-up': 'slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'scan-line': 'scanline 8s linear infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'blizzard': 'blizzard 30s linear infinite',
                        'dash': 'dash 2.5s ease-out forwards',
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        slideUp: { '0%': { opacity: '0', transform: 'translateY(15px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        blizzard: {
                            '0%': { backgroundPosition: '0 0, 0 0, 0 0' },
                            '100%': { backgroundPosition: '400px 1200px, 200px 600px, 100px 400px' }
                        },
                        dash: { from: { strokeDashoffset: '1000' }, to: { strokeDashoffset: '0' } }
                    }
                }
            }
        }
    </script>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;400;700&family=JetBrains+Mono:wght@300;400;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    
    <style>
        :root {
            --glass-blur: 16px; 
            --amber-primary: #e3b341;
            --transition-speed: 2s;
            --surface-color: rgba(20, 25, 30, 0.65);
            --border-color: rgba(255, 255, 255, 0.08);
        }

        html { background-color: #0c0b0a; margin: 0; overflow-x: hidden; }
        
        body { 
            background: radial-gradient(circle at 50% 30%, #1e293b 0%, #020617 100%);
            color: #ffffff; min-height: 100vh; font-family: "Noto Serif SC", serif;
        }

        /* ËÉåÊôØÂ±Ç */
        .bg-layer {
            position: fixed; inset: 0; 
            background-size: cover; background-position: center;
            background-repeat: no-repeat;
            transition: opacity var(--transition-speed) ease-in-out;
            pointer-events: none;
            z-index: -50;
            background-color: #101214; 
            filter: brightness(0.85) contrast(1.15) sepia(0.05) saturate(0.8);
        }
        
        /* Êó∂Èó¥Ëâ≤Ê∏©Êª§Èïú */
        #time-color-filter {
            position: fixed; inset: 0; pointer-events: none; 
            z-index: -45; transition: background-color 3s linear;
        }
        
        /* Èõ™Ëä±/‰∫ëÂ±Ç Canvas */
        #sky-layer {
            position: fixed; inset: 0; pointer-events: none; z-index: -42;
        }
        
        /* ÂõõÂ≠£Á≤íÂ≠ê Canvas */
        #season-particles {
            position: fixed; inset: 0; pointer-events: none; z-index: -40;
        }
        
        .snow-blizzard {
            position: fixed; inset: 0; pointer-events: none; z-index: -45;
            background-image: 
                radial-gradient(3px 3px at 100px 50px, rgba(255,255,255,0.8), transparent),
                radial-gradient(4px 4px at 200px 150px, rgba(255,255,255,0.7), transparent),
                radial-gradient(2px 2px at 300px 250px, rgba(255,255,255,0.6), transparent);
            background-size: 500px 500px, 400px 400px, 300px 300px;
            animation: blizzard 30s linear infinite;
            opacity: 0.35;
            mix-blend-mode: screen;
        }
        
        .vignette {
            position: fixed; inset: 0; z-index: -40;
            background: radial-gradient(circle at center, rgba(0,0,0,0) 20%, rgba(2, 6, 23, 0.7) 100%);
            pointer-events: none;
        }

        .layout-container {
            max-width: 1440px; margin: 0 auto; padding: 5rem 2rem;
            position: relative; z-index: 10;
        }

        /* Â∏ÉÂ±Ä */
        .titan-matrix {
            display: grid; gap: 1.5rem; grid-template-columns: repeat(1, 1fr);
        }

        @media (min-width: 1024px) {
            .titan-matrix {
                grid-template-columns: repeat(4, 1fr);
                grid-template-rows: 240px 240px auto auto auto; 
                padding-bottom: 8rem;
            }
            .card-m1 { grid-column: 1 / span 2; grid-row: 1 / span 2; }
            .card-m3 { grid-column: 3 / span 2; grid-row: 1; }
            .card-m2 { grid-column: 3 / span 2; grid-row: 2; }
            .card-writing { grid-column: 1 / span 4; grid-row: 3; min-height: 380px; }
            .card-m5 { grid-column: 1 / span 4; grid-row: 4; }
            .card-m6 { grid-column: 1 / span 4; grid-row: 5; }
        }

        .glass-cell {
            background: rgba(20, 25, 30, 0.6); 
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 32px; padding: 2rem;
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
            position: relative; overflow: hidden;
        }
        .glass-cell:hover {
            border-color: rgba(227, 179, 65, 0.4);
            transform: translateY(-2px);
            background: rgba(30, 40, 55, 0.75);
            box-shadow: 0 40px 80px -20px rgba(0, 0, 0, 0.7);
        }

        .precision-tag {
            font-family: 'JetBrains Mono', monospace;
            font-size: 9px; text-transform: uppercase;
            letter-spacing: 0.3em; color: rgba(255, 255, 255, 0.4); font-weight: 700;
        }

        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.15); border-radius: 10px; }
        
        .watcher-drawer-width { width: 100%; }
        @media (min-width: 768px) { .watcher-drawer-width { width: 520px; } }

        .auth-glow { color: var(--amber-primary) !important; filter: drop-shadow(0 0 12px var(--amber-primary)); }
        
        .fade-in-up { animation: fadeInUp 0.6s ease-out forwards; opacity: 0; transform: translateY(15px); }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }

        .header-circle-btn {
            width: 44px; height: 44px;
            border-radius: 9999px;
            background: rgba(255,255,255,0.04);
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(20px);
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .header-circle-btn:hover { border-color: rgba(227, 179, 65, 0.5); color: #e3b341; }
        
        .search-pill-expanded {
            width: 240px !important;
            border-radius: 9999px !important;
            padding-left: 1rem;
            justify-content: flex-start !important;
        }

        .dropdown-menu {
            opacity: 0; visibility: hidden; transform: translateY(10px) scale(0.95);
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            position: absolute; top: 3.5rem; right: 0;
            background: rgba(12, 13, 17, 0.95);
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(24px);
            border-radius: 20px;
            padding: 1.5rem;
            z-index: 50;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            min-width: 280px;
        }
        .dropdown-menu.active { opacity: 1; visibility: visible; transform: translateY(0) scale(1); }
        
        .asset-compact-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 0.75rem 1.25rem;
            display: flex; justify-content: space-between; align-items: center;
            transition: all 0.3s ease; margin-bottom: 0.5rem;
        }
        .asset-compact-item:hover { background: rgba(227, 179, 65, 0.1); border-color: rgba(227, 179, 65, 0.3); transform: translateX(4px); }

        /* ÂõæË°®Ê†∑Âºè */
        .chart-wrapper { position: relative; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; }
        .pie-chart {
            width: 140px; height: 140px; border-radius: 50%;
            position: relative; box-shadow: 0 0 20px rgba(0,0,0,0.5);
            flex-shrink: 0; margin-right: 2rem;
            background: #222;
        }
        .pie-chart::after {
            content: ''; position: absolute; inset: 40px; background: #15181e; border-radius: 50%;
        }
        .pie-label-container { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; pointer-events: none; z-index: 10; }
        .pie-legend { display: flex; flex-direction: column; gap: 0.8rem; justify-content: center; }
        .legend-item { display: flex; align-items: center; gap: 0.6rem; font-family: 'JetBrains Mono'; font-size: 11px; color: rgba(255,255,255,0.7); }
        .legend-dot { width: 8px; height: 8px; border-radius: 2px; }

        /* SVG Trend Chart Engine */
        svg.trend-chart { width: 100%; height: 100%; overflow: visible; }
        .trend-line { 
            fill: none; stroke: var(--amber-primary); stroke-width: 2; 
            stroke-linecap: round; stroke-linejoin: round; 
            stroke-dasharray: 1000; stroke-dashoffset: 1000; 
            animation: dash 2.5s ease-out forwards; 
            filter: drop-shadow(0 0 4px var(--amber-primary)); 
        }
        .trend-area { fill: url(#grad1); stroke: none; opacity: 0; animation: fadeIn 1s ease-out 1s forwards; }
        .grid-line { stroke: rgba(255,255,255,0.05); stroke-width: 1; }
        .trend-point { fill: #0c0b0a; stroke: var(--amber-primary); stroke-width: 2; r: 0; transition: all 0.2s; cursor: pointer; animation: popIn 0.5s ease-out forwards; animation-delay: 2s; }
        .trend-point:hover { r: 6; fill: white; }
        .axis-text { font-family: 'JetBrains Mono'; font-size: 9px; fill: rgba(255,255,255,0.4); text-anchor: middle; }
        
        @keyframes popIn { to { r: 3; } }

        .fab-publish {
            position: fixed; bottom: 40px; right: 40px;
            width: 64px; height: 64px; background: var(--amber-primary);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 10px 30px rgba(227, 179, 65, 0.3); color: #000; font-size: 24px;
            cursor: pointer; z-index: 100;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            opacity: 0; pointer-events: none; transform: scale(0.8);
        }
        .fab-publish.visible { opacity: 1; pointer-events: auto; transform: scale(1); }
        .fab-publish:hover { transform: scale(1.1) rotate(90deg); }
    </style>
</head>
<body class="opacity-0 animate-fade-in-pro">

    <!-- ËÉåÊôØÁ≥ªÁªü -->
    <div id="bg-layer-1" class="bg-layer"></div>
    <div id="bg-layer-2" class="bg-layer" style="opacity:0"></div>
    <div id="time-color-filter"></div>
    <canvas id="sky-layer"></canvas>
    <canvas id="season-particles"></canvas>
    <div class="snow-blizzard"></div>
    <div class="vignette"></div>

    <div class="layout-container">
        <!-- Â§¥ÈÉ®ÂØºËà™ -->
        <header class="flex flex-col lg:flex-row justify-between items-end gap-10 mb-20">
            <div class="w-full">
                <h1 class="text-5xl lg:text-7xl font-black tracking-[0.2em] font-serif mb-8 hover:text-amber-500 transition-all duration-1000">ÊµÅÂÖâÂ≠òÊ†π</h1>
                <div class="h-px w-64 bg-gradient-to-r from-amber-500/60 to-transparent mb-5"></div>
                <p class="text-xs lg:text-sm text-gray-400 italic font-serif opacity-80 tracking-[0.25em] leading-loose">
                    ÂÖ∑‰ΩìÁöÑÁîüÊ¥ªÔºåÊòØÊäµÂæ°ËôöÊó†ÁöÑÊúÄÂêé‰∏ÄÈÅìÈò≤Á∫ø„ÄÇ
                </p>
            </div>
            
            <div class="flex flex-col items-end gap-5">
                <div id="clockDisplay" class="font-mono text-[14px] text-amber-500 font-bold tracking-[0.4em] mb-1 drop-shadow-glow">00:00:00</div>
                
                <div class="flex items-center gap-4 relative">
                    <!-- ÊêúÁ¥¢ -->
                    <div class="header-btn-container relative">
                        <div id="searchPill" class="header-circle-btn overflow-hidden w-11 h-11" onclick="GardenOS.ui.activateSearch()">
                            <i id="searchIcon" class="ri-search-line text-lg text-white/50"></i>
                            <input type="text" id="headerSearchInput" onkeyup="GardenOS.ui.search(this.value)" onblur="GardenOS.ui.deactivateSearch()" class="hidden w-full bg-transparent border-0 outline-none text-xs font-mono text-white placeholder-white/30 h-full ml-2" placeholder="SEARCH...">
                        </div>
                    </div>
                    <!-- AI -->
                    <div class="header-btn-container relative">
                        <div id="aiBtn" onclick="GardenOS.ui.toggleDropdown('aiMenu')" class="header-circle-btn h-11 w-11 text-white/50 hover:text-amber-500 hover:border-amber-500/50">
                             <i class="ri-brain-line text-lg"></i>
                        </div>
                        <div id="aiMenu" class="dropdown-menu">
                            <div class="flex items-center gap-2 mb-4">
                                <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                                <span class="text-[10px] font-mono tracking-widest text-amber-500">DEEPSEEK_ONLINE</span>
                                <span id="aiUsageText" class="text-[9px] text-gray-500 ml-auto">0/15</span>
                            </div>
                            <div class="h-48 overflow-y-auto custom-scroll mb-4 border border-white/5 rounded-xl p-3 bg-black/20 text-xs text-gray-300 font-serif leading-relaxed" id="aiChatLog">
                                <span class="opacity-50">Á•ûÁªèÈìæË∑ØÂ∑≤ËøûÊé•„ÄÇ<br>Ê≠£Âú®ËØªÂèñÂÖ®Á´ôÊï∞ÊçÆ...<br>Â∞±Áª™„ÄÇ</span>
                            </div>
                            <div class="relative">
                                <input type="text" id="aiHeaderInput" onkeypress="GardenOS.api.handleAIInput(event)" class="w-full bg-white/5 border border-white/10 rounded-lg py-2 pl-3 pr-8 text-xs font-mono text-white outline-none focus:border-amber-500" placeholder="Ask AI...">
                                <i class="ri-corner-down-left-line absolute right-2 top-2 text-white/20 text-xs"></i>
                            </div>
                        </div>
                    </div>
                    <!-- ËÅîÁ≥ªÊñπÂºè -->
                    <div class="header-btn-container relative">
                        <div id="contactBtn" onclick="GardenOS.ui.toggleDropdown('contactMenu')" class="header-circle-btn h-11 w-11 text-white/50 hover:text-amber-500 hover:border-amber-500/50">
                             <i class="ri-signal-tower-line text-lg"></i>
                        </div>
                        <div id="contactMenu" class="dropdown-menu">
                             <div class="flex flex-col gap-3">
                                 <div class="group/c">
                                     <div class="text-amber-500/60 text-[9px] font-mono tracking-[0.2em] mb-1">EMAIL</div>
                                     <span class="text-sm font-serif text-white select-all border-b border-transparent group-hover/c:border-amber-500 transition-all">zjx207656@gmail.com</span>
                                 </div>
                                 <div class="group/c">
                                     <div class="text-amber-500/60 text-[9px] font-mono tracking-[0.2em] mb-1">WECHAT</div>
                                     <span class="text-sm font-serif text-white select-all border-b border-transparent group-hover/c:border-amber-500 transition-all">Zj_6174</span>
                                 </div>
                             </div>
                        </div>
                    </div>
                    <!-- Â≠£ËäÇ -->
                    <div id="seasonIndicator" class="header-circle-btn h-11 w-11 text-white/50 cursor-default" title="Winter">
                         <span id="linkDot" class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></span>
                    </div>
                    <!-- ÁôªÂΩï -->
                    <div onclick="GardenOS.ui.toggleLogin(true)" class="header-circle-btn h-11 w-11 text-white/50 hover:text-amber-500 hover:border-amber-500/50 cursor-pointer" title="Login">
                         <i id="lockIcon" class="ri-user-3-line text-lg"></i>
                    </div>
                </div>
            </div>
        </header>

        <main class="titan-matrix">
            <!-- M1 -->
            <div class="glass-cell card-m1 flex flex-col justify-between group h-full">
                <div>
                    <span class="precision-tag text-amber-500">Neural_Scale_v62.3</span>
                    <h2 class="text-4xl font-bold font-serif mt-12 mb-8 tracking-wide whitespace-nowrap">ÁîüÊ¥ªÂàªÂ∫¶</h2>
                    <div class="space-y-10">
                        <div>
                            <div class="flex justify-between text-[11px] font-mono opacity-40 mb-3 uppercase tracking-[0.5em]"><span>Entropy_Index</span><span id="valEntropy" class="text-amber-500 font-black">95.00%</span></div>
                            <div class="h-[1px] w-full bg-white/10 relative overflow-hidden"><div class="absolute h-full bg-white w-[95%] shadow-[0_0_20px_white]"></div></div>
                        </div>
                        <p id="valQuote" class="text-lg italic text-gray-300 font-serif leading-relaxed opacity-90 max-w-sm mt-8">"‰∏áÁâ©ÁöÜÊúâË£ÇÁóïÔºåÈÇ£ÊòØÂÖâËøõÊù•ÁöÑÂú∞Êñπ„ÄÇ"</p>
                    </div>
                </div>
                <div class="flex gap-20 pt-10 border-t border-white/10">
                    <div><div class="text-3xl font-mono font-light tracking-tighter"><span id="valWeight">55.0</span> <span class="text-[10px] opacity-30 uppercase font-black">Kg</span></div><div class="precision-tag mt-3 opacity-50">Mass</div></div>
                    <div><div class="text-3xl font-mono font-light tracking-tighter"><span id="valVitality">98</span> <span class="text-[10px] opacity-30 uppercase font-black">En</span></div><div class="precision-tag mt-3 opacity-50">Vitality</div></div>
                </div>
            </div>

            <!-- M3 -->
            <div id="ingestCard" class="glass-cell card-m3 flex flex-col justify-between">
                <div class="flex justify-between items-center mb-8"><span class="precision-tag text-white/40">// Ingest_Record</span><i class="ri-book-read-line text-white/20 text-xl"></i></div>
                <div id="ingestListContainer" class="overflow-y-auto custom-scroll h-full pr-3"><div id="ingestList" class="space-y-6"></div></div>
            </div>

            <!-- M2 -->
            <div id="memoCard" class="glass-cell card-m2 flex flex-col justify-start">
                <div class="flex justify-between items-center mb-6 pb-4 border-b border-white/10"><span class="precision-tag text-amber-500/60 tracking-widest">Fragmented_Echoes</span><i class="ri-chat-history-line text-white/20 text-xl"></i></div>
                <div id="memoList" class="w-full h-full overflow-y-auto custom-scroll pr-3 space-y-6 max-h-[160px]"></div>
            </div>

            <!-- Writing -->
            <div id="writingDeck" class="glass-cell card-writing flex flex-col justify-center items-center relative overflow-hidden group cursor-pointer" onclick="GardenOS.ui.toggleWritingDeck()">
                <div class="absolute inset-0 bg-black/60 group-hover:bg-black/40 transition-colors duration-1000"></div>
                <div id="writingCover" class="text-center relative z-10 transition-all duration-700">
                    <i class="ri-quill-pen-line text-4xl text-amber-500 mb-10 block animate-pulse"></i>
                    <h3 class="text-3xl lg:text-3xl font-serif italic text-white mb-8 tracking-[0.2em] leading-loose">"ÊñáÂ≠óÊòØÊçïËé∑Êó∂Èó¥ÁöÑÁΩëÔºå<br>ÊâìÊçûÊ≤âÊ≤°ÁöÑÂ≤ÅÊúà„ÄÇ"</h3>
                    <span class="precision-tag tracking-[1em] text-white/20 uppercase">Click to open archive</span>
                </div>
                <div id="writingList" class="hidden w-full max-w-5xl relative z-10 animate-fade-in-pro grid grid-cols-1 md:grid-cols-3 gap-10 p-8">
                     <a href="https://shade-plant-9cc.notion.site/2cd5c4b326c88025b72fd4fd1574d4c9?source=copy_link" target="_blank" class="bg-[#0c0d11]/90 p-10 rounded-[40px] border border-amber-500/20 hover:border-amber-500 hover:bg-black/90 transition-all group/item shadow-3xl relative block transform hover:-translate-y-2 searchable-item">
                        <div class="absolute top-0 left-0 w-1.5 h-full bg-amber-500 rounded-l-[40px]"></div>
                        <div class="flex justify-between items-center mb-6"><h4 class="text-2xl font-serif italic font-bold text-white group-hover/item:text-amber-500">ÈìúÂ∑ùÂæÄ‰∫ã</h4><i class="ri-external-link-line text-white/30 group-hover/item:text-amber-500 text-2xl"></i></div>
                        <p class="text-sm text-gray-400 font-serif leading-loose opacity-80">Ë¢´ÊäòÂè†ÁöÑÊó∂Èó¥Á¢éÁâáÔºå‰∏™‰ΩìÂú®ÂÆèÂ§ßÂèô‰∫ãÁºùÈöô‰∏≠ÁöÑÂëºÂê∏„ÄÇ</p>
                        <div class="mt-8"><span class="text-[10px] border border-white/20 px-3 py-1 rounded-full text-white/40 uppercase tracking-wider">Novel</span></div>
                    </a>
                    <div id="dynamicWritingContainer" class="contents"></div>
                </div>
            </div>

            <!-- M5 -->
            <div class="glass-cell card-m5">
                <div class="flex justify-between items-center mb-12"><span class="precision-tag text-white/30 tracking-[4em] uppercase">// Sensory_Laboratory</span><i class="ri-eye-2-line text-white/10 text-2xl"></i></div>
                <div id="sensoryGrid" class="grid grid-cols-2 md:grid-cols-5 gap-10">
                    <button class="flex flex-col items-center gap-5 group/btn searchable-item"><div class="w-16 h-16 bg-white/[0.04] rounded-[24px] flex items-center justify-center text-4xl border border-white/5 group-hover/btn:bg-amber-500/20 transition-all shadow-xl">‚õ©Ô∏è</div><span class="precision-tag opacity-40 group-hover/btn:opacity-100">Anime</span></button>
                    <button class="flex flex-col items-center gap-5 group/btn searchable-item"><div class="w-16 h-16 bg-white/[0.04] rounded-[24px] flex items-center justify-center text-4xl border border-white/5 group-hover/btn:bg-amber-500/20 transition-all shadow-xl">üïπÔ∏è</div><span class="precision-tag opacity-40 group-hover/btn:opacity-100">Game</span></button>
                    <button class="flex flex-col items-center gap-5 group/btn searchable-item"><div class="w-16 h-16 bg-white/[0.04] rounded-[24px] flex items-center justify-center text-4xl border border-white/5 group-hover/btn:bg-amber-500/20 transition-all shadow-xl">üé¨</div><span class="precision-tag opacity-40 group-hover/btn:opacity-100">Film</span></button>
                    <button class="flex flex-col items-center gap-5 group/btn searchable-item"><div class="w-16 h-16 bg-white/[0.04] rounded-[24px] flex items-center justify-center text-4xl border border-white/5 group-hover/btn:bg-amber-500/20 transition-all shadow-xl">üå≤</div><span class="precision-tag opacity-40 group-hover/btn:opacity-100">Vista</span></button>
                    <button class="flex flex-col items-center gap-5 group/btn searchable-item"><div class="w-16 h-16 bg-white/[0.04] rounded-[24px] flex items-center justify-center text-4xl border border-white/5 group-hover/btn:bg-amber-500/20 transition-all shadow-xl">üìª</div><span class="precision-tag opacity-40 group-hover/btn:opacity-100">Audio</span></button>
                </div>
            </div>

            <!-- M6: ËµÑ‰∫ßÁªàÁ´Ø -->
            <div class="glass-cell card-m6 min-h-[440px] overflow-hidden">
                <div class="flex justify-between items-start mb-14">
                    <span class="precision-tag text-white/30 tracking-[4em] uppercase">Wealth_Pulse</span>
                    <div class="flex items-center gap-3">
                         <button onclick="GardenOS.ui.switchChart('pie')" id="btnPie" class="text-[10px] text-amber-500 hover:text-white font-bold transition-colors">DISTRIBUTION</button>
                         <span class="text-white/20">|</span>
                         <button onclick="GardenOS.ui.switchChart('trend')" id="btnTrend" class="text-[10px] text-white/50 hover:text-amber-500 font-bold transition-colors">TREND</button>
                    </div>
                </div>
                <div class="flex flex-col lg:flex-row gap-12 h-full">
                    <!-- Â∑¶‰æßÔºö‰∏ÄÂàóËµÑ‰∫ß -->
                    <div id="assetList" class="w-full lg:w-1/3 flex flex-col gap-2 pr-2 h-full">
                        <!-- JS Â°´ÂÖÖ -->
                    </div>
                    
                    <!-- Âè≥‰æßÔºöÂèØËßÜÂåñÂå∫Âüü -->
                    <div id="vizContainer" class="w-full lg:w-2/3 bg-black/40 rounded-[48px] border border-white/5 relative overflow-hidden flex flex-col items-center justify-center p-8 shadow-inner">
                        <!-- È•ºÂõæ (ÈªòËÆ§) -->
                        <div id="pieChart" class="chart-wrapper w-full h-full flex flex-row items-center justify-center">
                            <div class="pie-chart"></div>
                            <div class="pie-label-container absolute">
                                <span class="text-xl font-mono font-bold text-white mb-1">910</span>
                                <span class="text-[9px] tracking-widest text-white/50 uppercase">Total</span>
                            </div>
                            <div class="pie-legend absolute bottom-4 flex gap-3 text-[9px] text-white/40 font-mono">
                                <div class="legend-item"><div class="legend-dot bg-amber-500"></div> FUNDS</div>
                                <div class="legend-item"><div class="legend-dot bg-green-500"></div> CRYPTO</div>
                                <div class="legend-item"><div class="legend-dot bg-blue-500"></div> METAL</div>
                            </div>
                        </div>
                        
                        <!-- Ë∂ãÂäøÂõæ (ÁÇπÂáªÂàáÊç¢) -->
                        <div id="trendChart" class="chart-wrapper hidden w-full h-full p-4 relative">
                            <svg class="trend-chart" viewBox="0 0 300 150">
                                <defs><linearGradient id="grad1" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:rgb(227, 179, 65);stop-opacity:0.2" /><stop offset="100%" style="stop-color:rgb(227, 179, 65);stop-opacity:0" /></linearGradient></defs>
                                <path class="trend-area" d="M0,150 L0,150 L300,150 Z" fill="url(#grad1)"/>
                                <polyline class="trend-line" points="" style="fill:none;stroke:#e3b341;stroke-width:2;" />
                                <!-- JS Will Inject Text Labels -->
                            </svg>
                            <!-- X Axis Labels Container -->
                            <div id="xAxisLabels" class="absolute bottom-2 left-0 w-full flex justify-between px-2 pointer-events-none"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- FAB -->
        <div id="fabPublish" onclick="GardenOS.ui.toggleWatcher(true)" class="fab-publish"><i class="ri-add-line"></i></div>
    </div>

    <!-- ‰æßËæπÊ†èÔºöÂèëÂ∏É‰∏≠ÂøÉ -->
    <aside id="watcherDrawer" class="fixed top-0 right-[-100%] h-full bg-[#0c0b0a]/98 backdrop-blur-3xl border-l border-white/10 z-[200] transition-all duration-1000 cubic-bezier(0.16, 1, 0.3, 1) p-12 flex flex-col no-scrollbar shadow-3xl overflow-y-auto watcher-drawer-width">
        <div class="flex justify-between items-center mb-12">
            <h2 class="text-3xl font-serif italic font-black tracking-[0.2em] uppercase text-white">COMMAND_CTR</h2>
            <button onclick="GardenOS.ui.toggleWatcher(false)" class="p-4 text-2xl text-gray-500 hover:text-white transition-all hover:rotate-90">‚úï</button>
        </div>
        <div class="flex-grow flex flex-col">
            <div id="adminPostArea" class="hidden mb-12 p-8 bg-white/[0.02] border border-amber-500/20 rounded-[48px] space-y-6 animate-fade-in-pro shadow-2xl">
                <div class="flex justify-between items-center mb-4"><span class="precision-tag text-amber-500 font-black tracking-[0.5em] uppercase">Control_Matrix</span><div class="w-2.5 h-2.5 bg-green-500 rounded-full animate-ping"></div></div>
                <div class="space-y-5">
                    <select id="postTarget" class="w-full bg-black/70 border border-white/10 rounded-xl p-5 text-xs font-mono text-white outline-none focus:border-amber-500 cursor-pointer"><option value="memo">Á¢éÁ¢éÂøµ</option><option value="writing">ÂÜô‰ΩúÂå∫</option><option value="ingest">ÊëÑÂÖ•Âå∫</option><option value="sensory">ÊÑüÂÆòÂå∫</option><option value="assets">ËµÑ‰∫ßÂå∫</option><option value="status">ÁîüÂëΩ‰ΩìÂæÅ</option></select>
                    <input type="text" id="postTitle" class="w-full bg-black/70 border border-white/10 rounded-xl p-5 text-xs font-mono text-white outline-none focus:border-amber-500" placeholder="TITLE / BOOK NAME / WEIGHT">
                    <div class="grid grid-cols-2 gap-4"><input type="text" id="linkText" class="bg-black/70 border border-white/10 rounded-xl p-5 text-xs font-mono text-white outline-none focus:border-amber-500" placeholder="LABEL / ENTROPY"><input type="text" id="linkUrl" class="bg-black/70 border border-white/10 rounded-xl p-5 text-xs font-mono text-white outline-none focus:border-amber-500" placeholder="URL"></div>
                    <input type="text" id="postImage" class="w-full bg-black/70 border border-white/10 rounded-xl p-5 text-xs font-mono text-white outline-none focus:border-amber-500" placeholder="IMAGE_URL / VITALITY">
                    <textarea id="postContent" class="w-full bg-black/70 border border-white/10 rounded-xl p-5 text-xs font-serif italic text-gray-300 outline-none focus:border-amber-500 h-36" placeholder="Content..."></textarea>
                    <button onclick="GardenOS.cms.createPost()" class="w-full py-5 bg-amber-500 text-black font-black uppercase tracking-[0.8em] text-[10px] rounded-2xl shadow-glow active:scale-95 transition-all">EXECUTE_PUBLISH</button>
                </div>
            </div>
            <div id="aiResponseSide" class="min-h-[120px] font-serif italic text-gray-400 p-8 bg-white/[0.01] rounded-[32px] border-l-4 border-white/10 mb-8 leading-relaxed text-sm"><span class="text-white/20 font-mono">SYSTEM_LOG:</span> Á≠âÂæÖÂèëÂ∏ÉÊåá‰ª§...</div>
        </div>
    </aside>

    <div id="loginModal" class="fixed inset-0 bg-black/98 z-[500] hidden items-center justify-center p-6 backdrop-blur-3xl">
        <div class="bg-[#0c0d11] p-12 rounded-[56px] border border-white/10 w-full max-w-md text-center shadow-3xl relative overflow-hidden">
            <span class="precision-tag mb-10 block tracking-[0.6em] text-amber-500 font-black relative z-10">Root_Identity_Auth</span>
            <input type="password" id="authKeyInput" class="w-full bg-white/5 border border-white/10 rounded-[32px] p-8 text-center text-2xl font-mono text-white mb-10 tracking-[0.5em] focus:border-amber-500 outline-none shadow-inner relative z-10">
            <div class="flex gap-5 relative z-10"><button onclick="GardenOS.ui.toggleLogin(false)" class="flex-1 precision-tag py-6 hover:text-white transition-all tracking-[0.5em] text-[10px]">Abort</button><button onclick="GardenOS.auth.verify()" class="flex-1 py-6 bg-white/5 border border-white/10 rounded-[24px] font-black text-amber-500 tracking-[1em] text-[11px] hover:bg-white/10 active:scale-95 transition-all shadow-xl">Connect</button></div>
        </div>
    </div>

    <script>
        // =========================================================
        // ÂÆåÊï¥ÁöÑÁéØÂ¢ÉÁ≥ªÁªüÈÖçÁΩÆ
        // =========================================================
        const ASSET_MANIFEST = {
            spring: {
                morning: ['1490750967868-88aa4486c946'],
                noon: ['1500530855697-b586d89ba3ee'],
                sunset: ['1493244040629-496f6d136cc8'],
                night: ['1502082553048-f009c37129b9']
            },
            summer: {
                morning: ['1501004318641-b39e6451bec6'],
                noon: ['1507525428034-b723cf961d3e'],
                sunset: ['1501973801540-537f08ccae7b'],
                night: ['1502082553048-f009c37129b9']
            },
            autumn: {
                morning: ['1500534314209-a26db0f5b2c1'],
                noon: ['1476820865390-c52aeebb9891'],
                sunset: ['1501975558162-0be7c1c2d46a'],
                night: ['1478144592103-25e218a04891']
            },
            winter: {
                morning: ['1483921020237-603db42bf712'],
                noon: ['1517299321609-52c1da131a1f'],
                sunset: ['1519757609205-09d577484df8'],
                night: ['1518536862590-b0c6096054d5', '1478131143081-80f7f84ca84d']
            }
        };

        // =========================================================
        // ÂõõÂ≠£Á≤íÂ≠êÁ≥ªÁªü
        // =========================================================
        const SeasonParticleEngine = {
            canvas: null, ctx: null, particles: [], season: null,

            init() {
                this.canvas = document.getElementById('season-particles');
                if (!this.canvas) return;
                this.ctx = this.canvas.getContext('2d');
                this.resize();
                window.addEventListener('resize', () => this.resize());
                this.loop();
                setInterval(() => this.syncSeason(), 5000);
            },

            resize() {
                if (!this.canvas) return;
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            },

            syncSeason() {
                const currentSeason = GardenOS?.state?.currentSeason || 'winter';
                if (this.season !== currentSeason) {
                    this.season = currentSeason;
                    this.particles = [];
                    this.spawn();
                }
            },

            spawn() {
                const count = { spring: 60, summer: 40, autumn: 80, winter: 100 }[this.season] || 0;
                for (let i = 0; i < count; i++) {
                    this.particles.push(this.create());
                }
            },

            create() {
                const p = {
                    x: Math.random() * (this.canvas?.width || window.innerWidth),
                    y: Math.random() * (this.canvas?.height || window.innerHeight),
                    vy: Math.random() * 0.6 + 0.2,
                    r: Math.random() * 2 + 1
                };
                p.color = {
                    spring: 'rgba(255,200,220,0.6)',
                    summer: 'rgba(255,255,200,0.6)',
                    autumn: 'rgba(200,120,60,0.6)',
                    winter: 'rgba(255,255,255,0.8)'
                }[this.season] || 'rgba(255,255,255,0.8)';
                return p;
            },

            loop() {
                if (!this.ctx || !this.canvas) return;
                
                requestAnimationFrame(() => this.loop());
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                this.particles.forEach(p => {
                    p.y += p.vy;
                    if (p.y > this.canvas.height) p.y = -10;
                    this.ctx.fillStyle = p.color;
                    this.ctx.beginPath();
                    this.ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
                    this.ctx.fill();
                });
            }
        };

        // =========================================================
        // Â§©Á©∫/‰∫ëÂ±ÇÁ≥ªÁªü
        // =========================================================
        const SkyEngine = {
            canvas: null, ctx: null, elements: [], mode: null,

            init() {
                this.canvas = document.getElementById('sky-layer');
                if (!this.canvas) return;
                this.ctx = this.canvas.getContext('2d');
                this.resize();
                window.addEventListener('resize', () => this.resize());
                setInterval(() => this.sync(), 4000);
                this.loop();
            },

            resize() {
                if (!this.canvas) return;
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            },

            sync() {
                const phase = GardenOS?.state?.currentPhase || 'night';
                let mode = null;
                if (phase === 'night') mode = 'stars';
                else if (phase === 'morning' || phase === 'noon') mode = 'clouds';
                else mode = 'none';

                if (mode !== this.mode) {
                    this.mode = mode;
                    this.elements = [];
                    this.spawn();
                }
            },

            spawn() {
                if (this.mode === 'stars') {
                    for (let i = 0; i < 120; i++) {
                        this.elements.push({
                            x: Math.random() * (this.canvas?.width || window.innerWidth),
                            y: Math.random() * (this.canvas?.height || window.innerHeight),
                            r: Math.random() * 1.2 + 0.3,
                            a: Math.random(),
                            da: Math.random() * 0.01 + 0.002
                        });
                    }
                }
                if (this.mode === 'clouds') {
                    for (let i = 0; i < 12; i++) {
                        this.elements.push({
                            x: Math.random() * (this.canvas?.width || window.innerWidth),
                            y: Math.random() * (this.canvas?.height || window.innerHeight) * 0.6,
                            w: Math.random() * 300 + 200,
                            h: Math.random() * 80 + 40,
                            vx: Math.random() * 0.15 + 0.05
                        });
                    }
                }
            },

            loop() {
                if (!this.ctx || !this.canvas) return;
                
                requestAnimationFrame(() => this.loop());
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

                if (this.mode === 'stars') {
                    this.elements.forEach(s => {
                        s.a += s.da;
                        if (s.a > 1 || s.a < 0) s.da *= -1;
                        this.ctx.fillStyle = `rgba(255,255,255,${s.a})`;
                        this.ctx.beginPath();
                        this.ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
                        this.ctx.fill();
                    });
                }

                if (this.mode === 'clouds') {
                    this.ctx.fillStyle = 'rgba(255,255,255,0.15)';
                    this.elements.forEach(c => {
                        c.x += c.vx;
                        if (c.x - c.w > this.canvas.width) c.x = -c.w;
                        this.ctx.beginPath();
                        this.ctx.ellipse(c.x, c.y, c.w, c.h, 0, 0, Math.PI * 2);
                        this.ctx.fill();
                    });
                }
            }
        };

        // =========================================================
        // ‰∏ªÁ≥ªÁªü
        // =========================================================
        const GardenOS = {
            config: { 
                secret: 'Zjx207661', 
                storageKey: 'garden_v62_3_db', 
                deepSeekApiKey: 'sk-437d432e53664e489b60a9349619a879', 
                dailyLimit: 15 
            },
            data: {
                defaultContent: {
                    assets: [
                        {title: '01 // FUNDS', content: '700.00', val: 700},
                        {title: '02 // STOCKS', content: '0.00', val: 0},
                        {title: '03 // CRYPTO', content: '150.00', val: 150},
                        {title: '04 // METAL', content: '60.00 GR', val: 60}
                    ],
                    ingest: { title: '„ÄäÁåÆÁªôÈòøÂ∞îÂêâ‰æ¨ÁöÑËä±Êùü„Äã', content: 'Êô∫ÊÖßÊòØÂ≠§Áã¨ÁöÑËß£ËçØ„ÄÇ' },
                    memo: '"Â≤ÅÊúà‰∏çËØ≠ÔºåÂîØÊúâÊñáÂ≠óËÉΩÂú®Â§ßÈõ™‰∏≠ÂèñÊöñ„ÄÇ"'
                }
            },
            state: { 
                isAuthorized: false, 
                currentSeason: 'winter', 
                currentPhase: 'night', 
                activeBgLayer: 1, 
                lastLoadedUrl: '' 
            },

            boot() {
                this.auth.init();
                this.environment.sync(true);
                this.ui.init();
                this.cms.renderAll();
                
                // ÂàùÂßãÂåñÊó∂Èíü
                this.updateClock();
                setInterval(() => this.updateClock(), 1000);
                
                // ÁéØÂ¢ÉÁ≥ªÁªüÂÆöÊó∂Êõ¥Êñ∞
                setInterval(() => this.environment.checkUpdate(), 60000); // ÊØèÂàÜÈíüÊ£ÄÊü•
                
                // ÂàùÂßãÂåñÁ≤íÂ≠êÁ≥ªÁªü
                setTimeout(() => {
                    SeasonParticleEngine.init();
                    SkyEngine.init();
                }, 1000);
            },

            updateClock() {
                const now = new Date();
                const timeStr = now.toLocaleTimeString('zh-CN', { hour12: false });
                const clockEl = document.getElementById('clockDisplay');
                if (clockEl) {
                    clockEl.textContent = timeStr;
                }
            },

            api: {
                getUsage() { 
                    const today = new Date().toDateString();
                    const usage = JSON.parse(localStorage.getItem('garden_ai_usage') || '{}'); 
                    return usage.date !== today ? {date: today, count: 0} : usage; 
                },
                updateUsage(c) { 
                    localStorage.setItem('garden_ai_usage', JSON.stringify({date: new Date().toDateString(), count: c})); 
                    const usageEl = document.getElementById('aiUsageText');
                    if (usageEl) usageEl.innerText = `${c}/15`; 
                },
                async handleAIInput(e) {
                    if (e.key === 'Enter') {
                        const val = e.target.value.trim(); 
                        if (!val) return;
                        
                        const usage = this.getUsage();
                        if (usage.count >= GardenOS.config.dailyLimit) { 
                            this.typewriter("Limit reached.", `ai_${Date.now()}`); 
                            e.target.disabled = true; 
                            return; 
                        }
                        
                        const log = document.getElementById('aiChatLog'); 
                        log.innerHTML += `<div class="mb-2 text-white">> ${val}</div>`; 
                        e.target.value = '';
                        
                        const lid = Date.now(); 
                        log.innerHTML += `<div id="r_${lid}" class="text-amber-500 mb-4 opacity-50">Thinking...</div>`;
                        
                        const res = await this.callDeepSeek(val, "");
                        document.getElementById(`r_${lid}`).remove();
                        
                        const id = Date.now(); 
                        log.innerHTML += `<div id="res_${id}" class="text-amber-500 mb-4 text-xs font-mono"></div>`;
                        this.typewriter(res, `res_${id}`);
                        this.updateUsage(usage.count + 1);
                    }
                },
                async callDeepSeek(p, c) {
                    if (!GardenOS.config.deepSeekApiKey) return "[OFFLINE]";
                    try {
                        const r = await fetch('https://api.deepseek.com/chat/completions', { 
                            method: 'POST', 
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${GardenOS.config.deepSeekApiKey}`
                            }, 
                            body: JSON.stringify({
                                model: "deepseek-chat",
                                messages: [
                                    {role: "system", content: c},
                                    {role: "user", content: p}
                                ]
                            })
                        });
                        const d = await r.json(); 
                        return d.choices?.[0]?.message?.content || "No response";
                    } catch(e) { 
                        return "Error: " + e.message; 
                    }
                },
                typewriter(t, id) { 
                    const el = document.getElementById(id); 
                    let i = 0; 
                    const tm = setInterval(() => { 
                        if (!el) return clearInterval(tm); 
                        el.innerText += t.charAt(i++); 
                        if (i >= t.length) clearInterval(tm); 
                    }, 20); 
                }
            },

            auth: {
                init() {
                    const stored = JSON.parse(localStorage.getItem(GardenOS.config.storageKey) || '{}');
                    if (stored.isAuthorized) { 
                        GardenOS.state.isAuthorized = true; 
                        GardenOS.ui.updateAuthUI(true); 
                    }
                },
                verify() {
                    const val = document.getElementById('authKeyInput').value;
                    if (val === GardenOS.config.secret) {
                        GardenOS.state.isAuthorized = true;
                        localStorage.setItem(GardenOS.config.storageKey, JSON.stringify({isAuthorized: true}));
                        GardenOS.ui.toggleLogin(false); 
                        GardenOS.ui.updateAuthUI(true);
                    } else {
                        // ÈîôËØØÂèçÈ¶à
                        const input = document.getElementById('authKeyInput');
                        input.style.borderColor = '#ff4757';
                        setTimeout(() => input.style.borderColor = '', 1000);
                    }
                }
            },

            environment: {
                getSeason(d = new Date()) {
                    const m = d.getMonth() + 1;
                    if (m >= 3 && m <= 5) return 'spring';
                    if (m >= 6 && m <= 8) return 'summer';
                    if (m >= 9 && m <= 11) return 'autumn';
                    return 'winter';
                },

                getPhase(d = new Date()) {
                    const h = d.getHours();
                    if (h >= 5 && h < 10) return 'morning';
                    if (h >= 10 && h < 17) return 'noon';
                    if (h >= 17 && h < 19) return 'sunset';
                    return 'night';
                },

                sync(force = false) {
                    const now = new Date();
                    const s = this.getSeason(now);
                    const p = this.getPhase(now);
                    
                    if (!force && s === GardenOS.state.currentSeason && p === GardenOS.state.currentPhase) return;
                    
                    GardenOS.state.currentSeason = s;
                    GardenOS.state.currentPhase = p;
                    
                    // Êõ¥Êñ∞Â≠£ËäÇÊåáÁ§∫Âô®
                    const seasonNames = { spring: 'Êò•', summer: 'Â§è', autumn: 'Áßã', winter: 'ÂÜ¨' };
                    const seasonBtn = document.getElementById('seasonIndicator');
                    if (seasonBtn) {
                        const seasonChar = seasonNames[s] || 'ÂÜ¨';
                        seasonBtn.setAttribute('title', seasonChar);
                    }
                    
                    // Ëé∑ÂèñÂØπÂ∫îÂõæÁâá
                    const pool = ASSET_MANIFEST[s]?.[p];
                    if (!pool || pool.length === 0) return;
                    
                    const id = pool[Math.floor(Math.random() * pool.length)];
                    const url = `https://images.unsplash.com/photo-${id}?ixlib=rb-4.0.3&auto=format&fit=crop&q=80&w=2400`;
                    
                    // ÈÅøÂÖçÈáçÂ§çÂä†ËΩΩÂêå‰∏ÄÂõæÁâá
                    if (!force && url === GardenOS.state.lastLoadedUrl) return;
                    
                    // ÂèåÂõæÂ±ÇÂπ≥ÊªëËøáÊ∏°
                    const nextLayer = GardenOS.state.activeBgLayer === 1 ? 2 : 1;
                    const currentLayer = GardenOS.state.activeBgLayer;
                    
                    const nextEl = document.getElementById(`bg-layer-${nextLayer}`);
                    const currentEl = document.getElementById(`bg-layer-${currentLayer}`);
                    
                    if (nextEl && currentEl) {
                        nextEl.style.backgroundImage = `url('${url}')`;
                        nextEl.style.opacity = '0';
                        
                        // ÂºÄÂßãËøáÊ∏°
                        setTimeout(() => {
                            nextEl.style.opacity = '1';
                            currentEl.style.opacity = '0';
                            
                            // Êõ¥Êñ∞Áä∂ÊÄÅ
                            GardenOS.state.activeBgLayer = nextLayer;
                            GardenOS.state.lastLoadedUrl = url;
                            
                            // Ê†πÊçÆÊó∂ÊÆµË∞ÉÊï¥ËßÜËßâÊïàÊûú
                            this.adjustVisualEffects(p);
                        }, 100);
                    }
                },

                adjustVisualEffects(phase) {
                    // Ë∞ÉÊï¥Èõ™Ëä±ÊïàÊûú
                    const snowEl = document.querySelector('.snow-blizzard');
                    if (snowEl) {
                        const snowOpacity = (phase === 'night' || phase === 'morning') ? '0.35' : '0';
                        snowEl.style.opacity = snowOpacity;
                    }
                    
                    // Êõ¥Êñ∞Êó∂Èó¥Ëâ≤Ê∏©Êª§Èïú
                    this.updateTimeFilter(phase);
                },

                updateTimeFilter(phase) {
                    const filterMap = {
                        morning: 'rgba(255, 220, 180, 0.25)',
                        noon: 'rgba(255, 255, 255, 0)',
                        sunset: 'rgba(255, 160, 120, 0.35)',
                        night: 'rgba(20, 40, 80, 0.45)'
                    };
                    
                    let filterEl = document.getElementById('time-color-filter');
                    if (!filterEl) {
                        filterEl = document.createElement('div');
                        filterEl.id = 'time-color-filter';
                        filterEl.style.cssText = `
                            position: fixed; inset: 0; pointer-events: none; 
                            z-index: -45; transition: background-color 3s linear;
                        `;
                        document.body.appendChild(filterEl);
                    }
                    
                    filterEl.style.backgroundColor = filterMap[phase] || filterMap.night;
                },

                checkUpdate() {
                    this.sync(false);
                }
            },

            ui: {
                init() { 
                    // ÂÖ≥Èó≠ÊâÄÊúâ‰∏ãÊãâËèúÂçï
                    document.addEventListener('click', (e) => {
                        if (!e.target.closest('.header-btn-container')) {
                            document.querySelectorAll('.dropdown-menu').forEach(menu => {
                                menu.classList.remove('active');
                            });
                        }
                    });
                },
                toggleLogin(s) { 
                    const modal = document.getElementById('loginModal');
                    if (modal) modal.style.display = s ? 'flex' : 'none'; 
                    if (s) {
                        document.getElementById('authKeyInput').focus();
                        document.getElementById('authKeyInput').value = '';
                    }
                },
                toggleWatcher(s) { 
                    const drawer = document.getElementById('watcherDrawer');
                    if (drawer) drawer.style.right = s ? '0' : '-100%'; 
                },
                toggleDropdown(id) { 
                    const el = document.getElementById(id); 
                    if (!el) return;
                    
                    // ÂÖ≥Èó≠ÂÖ∂‰ªñËèúÂçï
                    ['contactMenu', 'aiMenu'].forEach(mid => { 
                        if (mid !== id) {
                            const otherMenu = document.getElementById(mid);
                            if (otherMenu) otherMenu.classList.remove('active');
                        }
                    });
                    
                    el.classList.toggle('active'); 
                },
                toggleWritingDeck() { 
                    const cover = document.getElementById('writingCover');
                    const list = document.getElementById('writingList');
                    if (cover && list) {
                        cover.classList.toggle('hidden');
                        list.classList.toggle('hidden');
                    }
                },
                activateSearch() { 
                    const searchPill = document.getElementById('searchPill');
                    const searchInput = document.getElementById('headerSearchInput');
                    if (searchPill && searchInput) {
                        searchPill.style.width = '240px';
                        searchInput.classList.remove('hidden');
                        searchInput.focus();
                    }
                },
                deactivateSearch() { 
                    const searchInput = document.getElementById('headerSearchInput');
                    const searchPill = document.getElementById('searchPill');
                    if (searchInput && searchPill && !searchInput.value) {
                        searchInput.classList.add('hidden');
                        searchPill.style.width = '44px';
                    }
                },
                search(v) { 
                    document.querySelectorAll('.searchable-item').forEach(el => {
                        el.style.display = el.innerText.toLowerCase().includes(v.toLowerCase()) ? '' : 'none';
                    }); 
                },
                updateAuthUI(auth) { 
                    if (auth) { 
                        const lockIcon = document.getElementById('lockIcon');
                        if (lockIcon) lockIcon.className = 'ri-shield-user-line text-amber-500';
                        
                        const adminArea = document.getElementById('adminPostArea');
                        if (adminArea) adminArea.classList.remove('hidden');
                        
                        const fab = document.getElementById('fabPublish');
                        if (fab) fab.classList.add('visible');
                    } 
                },
                
                switchChart(type) { 
                    const pieChart = document.getElementById('pieChart');
                    const trendChart = document.getElementById('trendChart');
                    const btnPie = document.getElementById('btnPie');
                    const btnTrend = document.getElementById('btnTrend');
                    
                    if (pieChart) pieChart.classList.toggle('hidden', type !== 'pie');
                    if (trendChart) trendChart.classList.toggle('hidden', type !== 'trend');
                    
                    if (btnPie) {
                        btnPie.className = type === 'pie' 
                            ? 'text-[10px] text-amber-500 font-bold transition-colors' 
                            : 'text-[10px] text-white/50 hover:text-amber-500 font-bold transition-colors';
                    }
                    
                    if (btnTrend) {
                        btnTrend.className = type === 'trend' 
                            ? 'text-[10px] text-amber-500 font-bold transition-colors' 
                            : 'text-[10px] text-white/50 hover:text-amber-500 font-bold transition-colors';
                    }
                },
                
                drawCharts(currentTotal) {
                    // È•ºÂõæ
                    const pieEl = document.querySelector('.pie-chart');
                    if (pieEl) {
                        const p1 = 77; // 700/910 ‚âà 77%
                        const p2 = 77 + 16; // 150/910 ‚âà 16%
                        pieEl.style.background = `conic-gradient(#e3b341 0% ${p1}%, #10b981 ${p1}% ${p2}%, #3b82f6 ${p2}% 100%)`;
                        
                        const labelSpan = document.querySelector('.pie-label-container span.text-xl');
                        if (labelSpan) labelSpan.innerText = currentTotal;
                    }
                    
                    // Ë∂ãÂäøÂõæ
                    const trendData = [];
                    for (let i = 6; i > 0; i--) {
                        const variance = 1 + (Math.random() * 0.1 - 0.05);
                        trendData.push(Math.floor(currentTotal * variance));
                    }
                    trendData.push(currentTotal);
                    
                    const min = Math.min(...trendData) * 0.95;
                    const max = Math.max(...trendData) * 1.05;
                    const range = max - min;
                    
                    const points = trendData.map((val, idx) => {
                        const x = idx * 50; 
                        const y = 150 - ((val - min) / range * 130 + 10); 
                        return `${x},${y}`;
                    }).join(' ');
                    
                    const svg = document.querySelector('.trend-chart');
                    if (svg) {
                        const area = svg.querySelector('.trend-area');
                        const line = svg.querySelector('.trend-line');
                        const axisContainer = document.getElementById('xAxisLabels');
                        
                        if (area) area.setAttribute('d', `M0,150 L${points.split(' ').join(' L')} L300,150 Z`);
                        if (line) line.setAttribute('points', points);
                        
                        // ÁßªÈô§ÊóßÁöÑÁÇπ
                        svg.querySelectorAll('circle').forEach(c => c.remove());
                        
                        // ÁîüÊàêÊñ∞ÁöÑÁÇπÂíåÊ†áÁ≠æ
                        if (axisContainer) axisContainer.innerHTML = '';
                        const days = [];
                        const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                        
                        for (let i = 6; i >= 0; i--) {
                            const d = new Date(); 
                            d.setDate(d.getDate() - i);
                            days.push(dayNames[d.getDay()]);
                        }

                        trendData.forEach((val, idx) => {
                            const x = idx * 50;
                            const y = 150 - ((val - min) / range * 130 + 10);
                            
                            // ÂàõÂª∫ÁÇπ
                            const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                            circle.setAttribute("cx", x);
                            circle.setAttribute("cy", y);
                            circle.setAttribute("class", "trend-point");
                            circle.setAttribute("data-value", val);
                            
                            const title = document.createElementNS("http://www.w3.org/2000/svg", "title");
                            title.textContent = `${days[idx]}: ${val}`;
                            circle.appendChild(title);
                            svg.appendChild(circle);
                            
                            // Ê∑ªÂä†XËΩ¥Ê†áÁ≠æ
                            if (axisContainer && idx < days.length) {
                                const label = document.createElement('div');
                                label.className = "text-[9px] text-white/30 font-mono absolute bottom-0";
                                label.style.left = `${(idx/6) * 100}%`;
                                label.style.transform = "translateX(-50%)";
                                label.innerText = days[idx];
                                axisContainer.appendChild(label);
                            }
                        });
                    }
                }
            },

            cms: {
                createPost() {
                    if (!GardenOS.state.isAuthorized) return;
                    
                    const target = document.getElementById('postTarget').value;
                    const title = document.getElementById('postTitle').value.trim();
                    const content = document.getElementById('postContent').value.trim();
                    const lText = document.getElementById('linkText').value.trim();
                    const lUrl = document.getElementById('linkUrl').value.trim();
                    const img = document.getElementById('postImage').value.trim();

                    if (target === 'status') {
                        const data = JSON.parse(localStorage.getItem(GardenOS.config.storageKey) || '{}');
                        data.status = { 
                            weight: title || '55.0', 
                            vitality: img || '98', 
                            entropy: lText || '95.00%', 
                            quote: content || '‰∏áÁâ©ÁöÜÊúâË£ÇÁóïÔºåÈÇ£ÊòØÂÖâËøõÊù•ÁöÑÂú∞Êñπ„ÄÇ' 
                        };
                        localStorage.setItem(GardenOS.config.storageKey, JSON.stringify(data));
                        GardenOS.cms.renderAll(); 
                        return;
                    }

                    if (!title || !content) return;
                    
                    const post = { 
                        id: Date.now(), 
                        target, 
                        title, 
                        content, 
                        link: {text: lText, url: lUrl}, 
                        image: img, 
                        timestamp: new Date().toLocaleString('zh-CN') 
                    };
                    
                    const data = JSON.parse(localStorage.getItem(GardenOS.config.storageKey) || '{}');
                    const posts = data.posts || []; 
                    posts.unshift(post); 
                    data.posts = posts;
                    
                    localStorage.setItem(GardenOS.config.storageKey, JSON.stringify(data));
                    
                    // Ê∏ÖÁ©∫Ë°®Âçï
                    ['postTitle', 'postContent', 'linkText', 'linkUrl', 'postImage'].forEach(id => {
                        const el = document.getElementById(id);
                        if (el) el.value = '';
                    });
                    
                    GardenOS.cms.renderAll();
                },
                
                renderAll() {
                    const data = JSON.parse(localStorage.getItem(GardenOS.config.storageKey) || '{}');
                    
                    // Êõ¥Êñ∞ÁîüÂëΩ‰ΩìÂæÅ
                    if (data.status) {
                        const valWeight = document.getElementById('valWeight');
                        const valVitality = document.getElementById('valVitality');
                        const valEntropy = document.getElementById('valEntropy');
                        const valQuote = document.getElementById('valQuote');
                        
                        if (valWeight) valWeight.innerText = data.status.weight || '55.0';
                        if (valVitality) valVitality.innerText = data.status.vitality || '98';
                        if (valEntropy) valEntropy.innerText = data.status.entropy || '95.00%';
                        if (valQuote) valQuote.innerText = data.status.quote || '‰∏áÁâ©ÁöÜÊúâË£ÇÁóïÔºåÈÇ£ÊòØÂÖâËøõÊù•ÁöÑÂú∞Êñπ„ÄÇ';
                    }
                    
                    // Ëé∑ÂèñÂÆπÂô®
                    const memoList = document.getElementById('memoList');
                    const ingestList = document.getElementById('ingestList');
                    const assetList = document.getElementById('assetList');
                    
                    if (!memoList || !ingestList || !assetList) return;
                    
                    // Ê∏ÖÁ©∫ÂÆπÂô®
                    memoList.innerHTML = '';
                    ingestList.innerHTML = '';
                    assetList.innerHTML = '';
                    
                    const posts = data.posts || [];
                    
                    // Ê∏≤ÊüìËµÑ‰∫ß
                    const defAssets = GardenOS.data.defaultContent.assets;
                    const userAssets = posts.filter(p => p.target === 'assets');
                    let totalValue = 0;
                    
                    const assetMix = [...userAssets];
                    for (let i = userAssets.length; i < 4; i++) { 
                        if (defAssets[i]) assetMix.push(defAssets[i]); 
                    }
                    
                    assetMix.slice(0, 4).forEach(p => {
                        const contentStr = p.content || p.val || '0';
                        let val = parseFloat(contentStr.toString().replace(/[^0-9.-]+/g, ""));
                        if (!isNaN(val)) totalValue += val;
                        
                        assetList.innerHTML += `
                            <div class="asset-compact-item searchable-item">
                                <div class="precision-tag text-amber-500/50">${p.title || 'ASSET'}</div>
                                <div class="text-base font-mono text-white group-hover:text-amber-500 transition-all">${contentStr}</div>
                            </div>
                        `;
                    });
                    
                    // ÁªòÂà∂ÂõæË°®
                    GardenOS.ui.drawCharts(Math.round(totalValue));
                    
                    // Ê∏≤ÊüìÊëÑÂÖ•ËÆ∞ÂΩï
                    if (!posts.some(p => p.target === 'ingest')) {
                        const defaultIngest = GardenOS.data.defaultContent.ingest;
                        ingestList.innerHTML = `
                            <div class="group flex gap-5 items-start cursor-pointer mb-6 border-b border-white/5 pb-4 searchable-item">
                                <div class="w-14 h-14 bg-white/10 rounded-2xl overflow-hidden flex-shrink-0 border border-white/5">
                                    <img src="https://images.unsplash.com/photo-1544947950-fa07a98d237f?ixlib=rb-4.0.3&auto=format&fit=crop&w=100" class="w-full h-full object-cover">
                                </div>
                                <div>
                                    <h4 class="text-sm font-bold font-serif group-hover:text-amber-500 transition-colors">${defaultIngest.title}</h4>
                                    <p class="text-[10px] text-gray-400 mt-1 font-serif">${defaultIngest.content}</p>
                                </div>
                            </div>
                        `;
                    }
                    
                    // Ê∏≤ÊüìÁî®Êà∑ÊëÑÂÖ•ËÆ∞ÂΩï
                    posts.filter(p => p.target === 'ingest').forEach(p => {
                        ingestList.innerHTML += `
                            <div class="group flex gap-5 items-start cursor-pointer mb-6 border-b border-white/5 pb-4 last:border-0 searchable-item">
                                <div class="w-14 h-14 bg-white/10 rounded-2xl overflow-hidden flex-shrink-0 border border-white/5">
                                    <img src="${p.image || 'https://via.placeholder.com/100'}" class="w-full h-full object-cover" onerror="this.src='https://via.placeholder.com/100'">
                                </div>
                                <div>
                                    <h4 class="text-sm font-bold group-hover:text-amber-500 transition-colors">${p.title}</h4>
                                    <p class="text-[10px] text-gray-400 mt-1">${p.content}</p>
                                </div>
                            </div>
                        `;
                    });
                    
                    // Ê∏≤ÊüìÁ¢éÁ¢éÂøµ
                    if (!posts.some(p => p.target === 'memo')) {
                        const defaultMemo = GardenOS.data.defaultContent.memo;
                        memoList.innerHTML = `
                            <div class="bg-white/5 p-4 rounded-[20px] border border-white/5 opacity-60 text-center">
                                <p class="text-xs text-gray-400 font-serif italic">${defaultMemo}</p>
                            </div>
                        `;
                    }
                    
                    // Ê∏≤ÊüìÁî®Êà∑Á¢éÁ¢éÂøµ
                    posts.filter(p => p.target === 'memo').forEach(p => {
                        const imgHtml = p.image ? `<img src="${p.image}" class="w-full h-auto object-cover rounded-lg mb-2 opacity-80" onerror="this.style.display='none'">` : '';
                        memoList.innerHTML += `
                            <div class="group/item bg-white/5 p-6 rounded-[28px] border border-white/5 mb-4 searchable-item">
                                <div class="flex justify-between items-center mb-3">
                                    <h4 class="text-sm font-bold">${p.title}</h4>
                                    <span class="text-[9px] text-white/20">${p.timestamp?.split(' ')[0] || ''}</span>
                                </div>
                                <p class="text-xs text-gray-400">${p.content}</p>
                                ${imgHtml}
                            </div>
                        `;
                    });
                }
            }
        };

        // =========================================================
        // ÂàùÂßãÂåñ
        // =========================================================
        document.addEventListener('DOMContentLoaded', () => {
            GardenOS.boot();
            
            // ÁÇπÂáªÈ°µÈù¢ÂÖ∂‰ªñÂú∞ÊñπÂÖ≥Èó≠‰∏ãÊãâËèúÂçï
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.header-btn-container')) {
                    document.querySelectorAll('.dropdown-menu').forEach(menu => {
                        menu.classList.remove('active');
                    });
                }
            });
        });
    </script>
</body>
</html>
